{% extends "course/course_detail.html" %}

{% load static %}

{% block course_detail_body %}
<div id="assignment-detail">
  <h2 class="border-bottom">{{ assignment.title }}</h2>
  <div class="assignment-body">
    {{ assignment.desc|linebreaks }}
  </div>
</div>
<hr />
{% if user.is_superuser or course.teacher == user %}
<div id="work-list" class="list-group">
  {% for work in work_list %}
    <div class="list-group-item">
      <div>
        {{ work.seat }} {{ work.stu.first_name }}
        {% if not work.created %}
          <span class="badge badge-danger">未繳交</span>
        {% else %}
          <span class="badge badge-light">
            <i class="fas fa-upload"></i>
            {{ work.created }}
          </span>
          {% if work.attach %}
          <a href="{% get_media_prefix %}{{ work.attach }}">
            <i class="fas fa-paperclip"></i> 副件下載
          </a>
          {% endif %}
        {% endif %}
      </div>
      {% if work.memo %}
      <div class="mt-2">
        {{ work.memo|linebreaks }}
      </div>
      {% endif %}
    </div>
  {% endfor %}
</div>
{% else %}
<div id="work-detail">
  {% if mywork %}
    <div class="card">
      {% if mywork.memo %}
      <div class="card-body">{{ mywork.memo|linebreaks }}</div>
      {% endif %}
      <div class="card-footer d-flex">
        {% if mywork.attachment %}
        <div>
          <i class="fas fa-paperclip"></i>
          <a href="{{mywork.attachment.url }}">
            附件下載
          </a>
        </div>
        {% endif %}
        <div class="ml-auto">
          <a href="{% url 'work_update' course.id mywork.id %}">
            <i class="fas fa-edit"></i>
          </a>
          <span class="badge badge-light">{{ mywork.created }}</span>
        </div>
      </div>
    </div>
  {% else %}
    <a href="{% url 'work_submit' course.id assignment.id %}" class="btn btn-sm btn-primary">
      <i class="fas fa-upload"></i> 繳交作業
    </a>
  {% endif %}
</div>
{% endif %}

{% endblock %}